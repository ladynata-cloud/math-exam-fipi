<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–¢—Ä–µ–Ω–∞–∂—ë—Ä –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è —á–∏—Å–µ–ª ‚Äî mathexam.space</title>
    <meta name="description" content="–¢—Ä–µ–Ω–∞–∂—ë—Ä –¥–ª—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö –≤–∏–¥–æ–≤ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è —á–∏—Å–µ–ª: —Ü–µ–ª—ã–µ, –¥–µ—Å—è—Ç–∫–∏, —Å–æ—Ç–Ω–∏, –¥–µ—Å—è—Ç—ã–µ, —Å–æ—Ç—ã–µ">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî¢</text></svg>">
    <link rel="stylesheet" href="style.css">
    <style>
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ */
        .visual-guide {
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(67, 97, 238, 0.05);
            border-radius: var(--radius);
            border: 1px solid rgba(67, 97, 238, 0.1);
        }
        
        .digit-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 4px;
            font-family: 'Courier New', monospace;
            font-size: 1.25rem;
            margin: 0.5rem 0;
            flex-wrap: wrap;
        }
        
        .digit {
            padding: 4px 8px;
            border-radius: 4px;
            min-width: 28px;
            text-align: center;
        }
        
        .digit.kept {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }
        
        .digit.rounding {
            background: rgba(239, 68, 68, 0.2);
            color: var(--error);
            border: 1px solid var(--error);
            font-weight: bold;
        }
        
        .digit.dropped {
            background: rgba(148, 163, 184, 0.2);
            color: var(--text-muted);
            text-decoration: line-through;
        }
        
        .decimal-point {
            font-weight: bold;
            color: var(--primary);
            padding: 0 2px;
        }
        
        .guide-text {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>üî¢ –¢—Ä–µ–Ω–∞–∂—ë—Ä –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è —á–∏—Å–µ–ª</h1>
            <p class="subtitle">–û—Ç—Ä–∞–±–æ—Ç–∞–π—Ç–µ –≤—Å–µ –≤–∏–¥—ã –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è: —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞, –¥–µ—Å—è—Ç–∫–∏, —Å–æ—Ç–Ω–∏, –¥–µ—Å—è—Ç—ã–µ, —Å–æ—Ç—ã–µ</p>
        </header>

        <!-- Stats -->
        <div class="stats-bar">
            <div class="stat-card">
                <div class="stat-value" id="completedCount">0</div>
                <div class="stat-label">–†–µ—à–µ–Ω–æ</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="correctCount">0</div>
                <div class="stat-label">–í–µ—Ä–Ω–æ</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="accuracy">0%</div>
                <div class="stat-label">–¢–æ—á–Ω–æ—Å—Ç—å</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="streak">0</div>
                <div class="stat-label">–°–µ—Ä–∏—è</div>
            </div>
        </div>

        <!-- Category Selector -->
        <div class="category-selector">
            <button class="category-btn active" data-category="integers">
                üî¢ –¶–µ–ª—ã–µ
            </button>
            <button class="category-btn" data-category="tens">
                üíØ –î–µ—Å—è—Ç–∫–∏
            </button>
            <button class="category-btn" data-category="hundreds">
                üî¢ –°–æ—Ç–Ω–∏
            </button>
            <button class="category-btn" data-category="decimals">
                üìä –î–µ—Å—è—Ç–∏—á–Ω—ã–µ
            </button>
            <button class="category-btn" data-category="mixed">
                üé≤ –°–º–µ—à–∞–Ω–Ω—ã–π
            </button>
        </div>

        <!-- Main Card -->
        <main class="task-card">
            <!-- Task Display -->
            <section class="task-display">
                <div class="task-instruction" id="taskInstruction">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏—è...</div>
                <div class="task-number" id="taskNumber"></div>
            </section>

            <!-- Visual Guide (for decimals) -->
            <div class="visual-guide" id="visualGuide" style="display: none;">
                <div class="digit-display" id="digitDisplay">
                    <!-- Digits will be inserted here -->
                </div>
                <div class="guide-text" id="guideText">
                    <!-- Guide text will be inserted here -->
                </div>
            </div>

            <!-- Input Section -->
            <section class="input-section">
                <div class="input-group">
                    <input 
                        type="text" 
                        id="userAnswer" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç..."
                        autocomplete="off"
                        aria-label="–í–∞—à –æ—Ç–≤–µ—Ç"
                    />
                    <button id="checkBtn" class="btn btn-primary">
                        ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
                    </button>
                </div>
            </section>

            <!-- Feedback -->
            <section class="feedback-section">
                <div id="feedback" role="alert" aria-live="assertive">
                    <!-- Feedback appears here -->
                </div>
                <div id="hint" class="guide-text" style="display: none; margin-top: 1rem;">
                    <!-- Hint appears here -->
                </div>
            </section>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button id="hintBtn" class="btn btn-secondary">
                    üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞
                </button>
                <button id="nextBtn" class="btn btn-primary" style="display: none;">
                    ‚û° –î–∞–ª–µ–µ
                </button>
                <button id="solutionBtn" class="btn btn-secondary" style="display: none;">
                    üìù –†–µ—à–µ–Ω–∏–µ
                </button>
            </div>
        </main>

        <!-- Rules -->
        <section class="rules-section">
            <div class="rules-header" id="rulesToggle">
                üìö –ü—Ä–∞–≤–∏–ª–∞ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è
                <span>‚ñº</span>
            </div>
            <div class="rules-content" id="rulesContent">
                <!-- Rules content inserted by JavaScript -->
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <p>üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—á–∫—É –¥–ª—è –¥–µ—Å—è—Ç–∏—á–Ω—ã—Ö –¥—Ä–æ–±–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä: 3.14)</p>
            <p>¬© 2025 –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç—Ä–µ–Ω–∞–∂—ë—Ä ‚Ä¢ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –û–ì–≠ ‚Ä¢ mathexam.space</p>
        </footer>
    </div>

    <script>
        // ===== GLOBAL VARIABLES =====
        let currentExample = null;
        let currentCategory = 'integers';
        let totalAttempts = 0;
        let correctAttempts = 0;
        let currentStreak = 0;
        let bestStreak = 0;
        let isButtonLocked = false;

        // ===== CATEGORY CONFIG =====
        const categories = {
            integers: {
                name: '—Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª',
                types: [
                    { name: '–¥–æ —Ü–µ–ª—ã—Ö', roundTo: 1, min: 1.1, max: 99.99, decimals: 2 }
                ]
            },
            tens: {
                name: '–¥–µ—Å—è—Ç–∫–æ–≤',
                types: [
                    { name: '–¥–æ –¥–µ—Å—è—Ç–∫–æ–≤', roundTo: 10, min: 15, max: 999, decimals: 0 }
                ]
            },
            hundreds: {
                name: '—Å–æ—Ç–µ–Ω',
                types: [
                    { name: '–¥–æ —Å–æ—Ç–µ–Ω', roundTo: 100, min: 150, max: 9999, decimals: 0 }
                ]
            },
            decimals: {
                name: '–¥–µ—Å—è—Ç–∏—á–Ω—ã—Ö –¥—Ä–æ–±–µ–π',
                types: [
                    { name: '–¥–æ –¥–µ—Å—è—Ç—ã—Ö', roundTo: 0.1, min: 1, max: 99, decimals: 3 },
                    { name: '–¥–æ —Å–æ—Ç—ã—Ö', roundTo: 0.01, min: 1, max: 99, decimals: 4 }
                ]
            },
            mixed: {
                name: '—Å–º–µ—à–∞–Ω–Ω—ã–π',
                types: [
                    { name: '–¥–æ —Ü–µ–ª—ã—Ö', roundTo: 1, min: 1.1, max: 99.99, decimals: 2 },
                    { name: '–¥–æ –¥–µ—Å—è—Ç–∫–æ–≤', roundTo: 10, min: 15, max: 999, decimals: 0 },
                    { name: '–¥–æ —Å–æ—Ç–µ–Ω', roundTo: 100, min: 150, max: 9999, decimals: 0 },
                    { name: '–¥–æ –¥–µ—Å—è—Ç—ã—Ö', roundTo: 0.1, min: 1, max: 99, decimals: 3 },
                    { name: '–¥–æ —Å–æ—Ç—ã—Ö', roundTo: 0.01, min: 1, max: 99, decimals: 4 }
                ]
            }
        };

        // ===== STORAGE =====
        function saveProgress() {
            const progress = {
                totalAttempts,
                correctAttempts,
                currentCategory,
                currentStreak,
                bestStreak,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('roundingTrainer2025', JSON.stringify(progress));
        }

        function loadProgress() {
            try {
                const saved = localStorage.getItem('roundingTrainer2025');
                if (saved) {
                    const progress = JSON.parse(saved);
                    totalAttempts = progress.totalAttempts || 0;
                    correctAttempts = progress.correctAttempts || 0;
                    currentCategory = progress.currentCategory || 'integers';
                    currentStreak = progress.currentStreak || 0;
                    bestStreak = progress.bestStreak || 0;
                    
                    // Update category buttons
                    document.querySelectorAll('.category-btn').forEach(btn => {
                        btn.classList.toggle('active', btn.dataset.category === currentCategory);
                    });
                    
                    updateStats();
                    updateRules();
                }
            } catch (e) {
                console.log('–ù–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å');
            }
        }

        // ===== TASK GENERATION =====
        function generateExample() {
            const category = categories[currentCategory];
            const type = category.types[Math.floor(Math.random() * category.types.length)];
            
            // Generate number
            let number;
            if (type.decimals > 0) {
                const multiplier = Math.pow(10, type.decimals);
                const min = Math.floor(type.min * multiplier);
                const max = Math.floor(type.max * multiplier);
                number = (Math.floor(Math.random() * (max - min + 1)) + min) / multiplier;
            } else {
                number = Math.floor(Math.random() * (type.max - type.min + 1)) + type.min;
            }

            // Calculate correct answer
            let correctAnswer;
            if (type.roundTo >= 1) {
                correctAnswer = Math.round(number / type.roundTo) * type.roundTo;
            } else {
                const multiplier = 1 / type.roundTo;
                correctAnswer = Math.round(number * multiplier) / multiplier;
            }

            // Format for display
            const formatNumber = (num) => {
                if (Number.isInteger(num) && type.roundTo >= 1) {
                    return num.toLocaleString('ru-RU');
                }
                // For decimals, show 2-4 decimal places
                let decimalPlaces = 0;
                if (type.roundTo === 1) decimalPlaces = 2;
                else if (type.roundTo === 0.1) decimalPlaces = 3;
                else if (type.roundTo === 0.01) decimalPlaces = 4;
                else decimalPlaces = 2;
                
                return num.toFixed(decimalPlaces).replace('.', ',');
            };

            currentExample = {
                number,
                type,
                correctAnswer,
                displayNumber: formatNumber(number),
                displayAnswer: formatNumber(correctAnswer)
            };

            updateDisplay();
            updateVisualGuide();
        }

        function updateDisplay() {
            document.getElementById('taskInstruction').textContent = 
                `–û–∫—Ä—É–≥–ª–∏—Ç–µ —á–∏—Å–ª–æ –¥–æ ${currentExample.type.name}:`;
            document.getElementById('taskNumber').textContent = 
                currentExample.displayNumber;
            document.getElementById('taskNumber').classList.add('fade-in');
            
            // Reset UI
            document.getElementById('userAnswer').value = '';
            document.getElementById('userAnswer').disabled = false;
            document.getElementById('userAnswer').classList.remove('error');
            document.getElementById('checkBtn').disabled = false;
            document.getElementById('feedback').innerHTML = '';
            document.getElementById('hint').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('solutionBtn').style.display = 'none';
            isButtonLocked = false;
            
            // Focus input
            setTimeout(() => {
                document.getElementById('userAnswer').focus();
            }, 100);
        }

        function updateVisualGuide() {
            const guide = document.getElementById('visualGuide');
            const digitDisplay = document.getElementById('digitDisplay');
            const guideText = document.getElementById('guideText');
            
            if (currentCategory === 'decimals' || currentCategory === 'mixed') {
                guide.style.display = 'block';
                
                const numStr = currentExample.number.toString();
                const roundTo = currentExample.type.roundTo;
                
                let roundingIndex;
                if (roundTo === 1) roundingIndex = numStr.indexOf('.');
                else if (roundTo === 0.1) roundingIndex = numStr.indexOf('.') + 1;
                else if (roundTo === 0.01) roundingIndex = numStr.indexOf('.') + 2;
                else roundingIndex = -1;
                
                let html = '';
                for (let i = 0; i < numStr.length; i++) {
                    const char = numStr[i];
                    if (char === '.') {
                        html += `<span class="decimal-point">,</span>`;
                    } else if (i < roundingIndex) {
                        html += `<span class="digit kept">${char}</span>`;
                    } else if (i === roundingIndex) {
                        html += `<span class="digit rounding">${char}</span>`;
                    } else {
                        html += `<span class="digit dropped">${char}</span>`;
                    }
                }
                
                digitDisplay.innerHTML = html;
                
                if (roundingIndex !== -1) {
                    const roundingDigit = parseInt(numStr[roundingIndex]);
                    guideText.textContent = roundingDigit >= 5 ? 
                        `–¶–∏—Ñ—Ä–∞ ${roundingDigit} ‚â• 5 ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ä–∞–∑—Ä—è–¥` :
                        `–¶–∏—Ñ—Ä–∞ ${roundingDigit} < 5 ‚Üí –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å`;
                }
            } else {
                guide.style.display = 'none';
            }
        }

        // ===== INPUT VALIDATION =====
        function validateInput(value) {
            if (!value.trim()) {
                showError('–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç');
                return false;
            }
            
            // Allow both comma and dot as decimal separator
            const normalized = value.replace(',', '.');
            
            if (!/^-?\d*\.?\d+$/.test(normalized)) {
                showError('–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—á–∫—É –∏–ª–∏ –∑–∞–ø—è—Ç—É—é)');
                return false;
            }
            
            return true;
        }

        function showError(message) {
            const input = document.getElementById('userAnswer');
            const feedback = document.getElementById('feedback');
            
            input.classList.add('error');
            feedback.innerHTML = `<div class="feedback-incorrect">‚ùå ${message}</div>`;
            
            setTimeout(() => input.classList.remove('error'), 1000);
        }

        // ===== ANSWER CHECKING =====
        function checkAnswer() {
            if (isButtonLocked) return;
            
            const input = document.getElementById('userAnswer');
            const value = input.value.trim();
            
            if (!validateInput(value)) return;
            
            // Parse answer
            const normalized = value.replace(',', '.');
            const userAnswer = parseFloat(normalized);
            
            // Check correctness with tolerance
            const tolerance = currentExample.type.roundTo < 1 ? 0.0001 : 0.1;
            const isCorrect = Math.abs(userAnswer - currentExample.correctAnswer) < tolerance;
            
            // Update stats
            totalAttempts++;
            if (isCorrect) {
                correctAttempts++;
                currentStreak++;
                if (currentStreak > bestStreak) bestStreak = currentStreak;
            } else {
                currentStreak = 0;
            }
            
            updateStats();
            
            // Show feedback
            const feedback = document.getElementById('feedback');
            if (isCorrect) {
                feedback.innerHTML = `
                    <div class="feedback-correct">
                        ‚úÖ –í–µ—Ä–Ω–æ! ${currentExample.displayNumber} ‚Üí ${currentExample.displayAnswer}
                        ${currentStreak > 1 ? `<br>üî• –°–µ—Ä–∏—è: ${currentStreak}` : ''}
                    </div>
                `;
            } else {
                feedback.innerHTML = `
                    <div class="feedback-incorrect">
                        ‚ùå –ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω–æ: ${currentExample.displayAnswer}
                    </div>
                `;
            }
            
            // Lock interface
            isButtonLocked = true;
            input.disabled = true;
            document.getElementById('checkBtn').disabled = true;
            document.getElementById('nextBtn').style.display = 'inline-flex';
            document.getElementById('solutionBtn').style.display = 'inline-flex';
            
            // Save progress
            saveProgress();
        }

        // ===== STATS =====
        function updateStats() {
            const accuracy = totalAttempts > 0 ? 
                Math.round((correctAttempts / totalAttempts) * 100) : 0;
            
            document.getElementById('completedCount').textContent = totalAttempts;
            document.getElementById('correctCount').textContent = correctAttempts;
            document.getElementById('accuracy').textContent = `${accuracy}%`;
            document.getElementById('streak').textContent = currentStreak;
            
            // Color coding
            const accuracyElem = document.getElementById('accuracy');
            if (accuracy >= 90) accuracyElem.style.color = '#10b981';
            else if (accuracy >= 70) accuracyElem.style.color = '#f59e0b';
            else accuracyElem.style.color = '#ef4444';
        }

        // ===== RULES =====
        function updateRules() {
            const content = document.getElementById('rulesContent');
            content.innerHTML = `
                <div class="rule-item">
                    <div class="rule-title">üî¢ –î–æ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª</div>
                    <div class="rule-text">–°–º–æ—Ç—Ä–∏–º –Ω–∞ –ø–µ—Ä–≤—É—é —Ü–∏—Ñ—Ä—É –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π. –ï—Å–ª–∏ 5-9 ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ü–µ–ª—É—é —á–∞—Å—Ç—å –Ω–∞ 1. –ü—Ä–∏–º–µ—Ä: 3.14 ‚Üí 3, 7.68 ‚Üí 8</div>
                </div>
                
                <div class="rule-item">
                    <div class="rule-title">üíØ –î–æ –¥–µ—Å—è—Ç–∫–æ–≤</div>
                    <div class="rule-text">–°–º–æ—Ç—Ä–∏–º –Ω–∞ —Ü–∏—Ñ—Ä—É –µ–¥–∏–Ω–∏—Ü. –ï—Å–ª–∏ 5-9 ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–µ—Å—è—Ç–∫–∏ –Ω–∞ 1. –ü—Ä–∏–º–µ—Ä: 47 ‚Üí 50, 43 ‚Üí 40</div>
                </div>
                
                <div class="rule-item">
                    <div class="rule-title">üî¢ –î–æ —Å–æ—Ç–µ–Ω</div>
                    <div class="rule-text">–°–º–æ—Ç—Ä–∏–º –Ω–∞ —Ü–∏—Ñ—Ä—É –¥–µ—Å—è—Ç–∫–æ–≤. –ï—Å–ª–∏ 5-9 ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–æ—Ç–Ω–∏ –Ω–∞ 1. –ü—Ä–∏–º–µ—Ä: 478 ‚Üí 500, 432 ‚Üí 400</div>
                </div>
                
                <div class="rule-item">
                    <div class="rule-title">üìä –î–æ –¥–µ—Å—è—Ç—ã—Ö (0.1)</div>
                    <div class="rule-text">–°–º–æ—Ç—Ä–∏–º –Ω–∞ —Å–æ—Ç—ã–µ. –ï—Å–ª–∏ 5-9 ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–µ—Å—è—Ç—ã–µ –Ω–∞ 1. –ü—Ä–∏–º–µ—Ä: 3.141 ‚Üí 3.1, 2.768 ‚Üí 2.8</div>
                </div>
                
                <div class="rule-item">
                    <div class="rule-title">üìä –î–æ —Å–æ—Ç—ã—Ö (0.01)</div>
                    <div class="rule-text">–°–º–æ—Ç—Ä–∏–º –Ω–∞ —Ç—ã—Å—è—á–Ω—ã–µ. –ï—Å–ª–∏ 5-9 ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–æ—Ç—ã–µ –Ω–∞ 1. –ü—Ä–∏–º–µ—Ä: 3.1416 ‚Üí 3.14, 2.7689 ‚Üí 2.77</div>
                </div>
            `;
        }

        // ===== EVENT HANDLERS =====
        document.addEventListener('DOMContentLoaded', function() {
            // Load progress
            loadProgress();
            
            // Generate first example
            generateExample();
            
            // Category buttons
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentCategory = this.dataset.category;
                    saveProgress();
                    generateExample();
                });
            });
            
            // Check button
            document.getElementById('checkBtn').addEventListener('click', checkAnswer);
            
            // Next button
            document.getElementById('nextBtn').addEventListener('click', generateExample);
            
            // Solution button
            document.getElementById('solutionBtn').addEventListener('click', function() {
                const hint = document.getElementById('hint');
                const roundTo = currentExample.type.roundTo;
                const number = currentExample.number;
                
                let solution = '';
                if (roundTo === 1) {
                    solution = `–ß–∏—Å–ª–æ ${number}. –ü–µ—Ä–≤–∞—è —Ü–∏—Ñ—Ä–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π: ${Math.floor((number * 10) % 10)}. `;
                    solution += Math.floor((number * 10) % 10) >= 5 ? 
                        `‚â• 5 ‚Üí ${Math.floor(number) + 1}` : `< 5 ‚Üí ${Math.floor(number)}`;
                } else if (roundTo === 10) {
                    solution = `–ß–∏—Å–ª–æ ${number}. –ï–¥–∏–Ω–∏—Ü—ã: ${number % 10}. `;
                    solution += number % 10 >= 5 ? 
                        `‚â• 5 ‚Üí ${Math.floor(number / 10) * 10 + 10}` : `< 5 ‚Üí ${Math.floor(number / 10) * 10}`;
                } else if (roundTo === 0.1) {
                    solution = `–ß–∏—Å–ª–æ ${number}. –°–æ—Ç—ã–µ: ${Math.floor(number * 100) % 10}. `;
                    solution += Math.floor(number * 100) % 10 >= 5 ? 
                        `‚â• 5 ‚Üí ${(Math.floor(number * 10) + 1) / 10}` : `< 5 ‚Üí ${Math.floor(number * 10) / 10}`;
                }
                
                hint.textContent = solution;
                hint.style.display = 'block';
            });
            
            // Hint button
            document.getElementById('hintBtn').addEventListener('click', function() {
                const hint = document.getElementById('hint');
                const roundTo = currentExample.type.roundTo;
                
                let hintText = '';
                if (roundTo === 1) {
                    hintText = '–°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –ø–µ—Ä–≤—É—é —Ü–∏—Ñ—Ä—É –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π. –ï—Å–ª–∏ 5-9 ‚Üí +1 –∫ —Ü–µ–ª–æ–π —á–∞—Å—Ç–∏';
                } else if (roundTo === 10) {
                    hintText = '–°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—ã. –ï—Å–ª–∏ 5-9 ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ –¥–µ—Å—è—Ç–∫–∏';
                } else if (roundTo === 100) {
                    hintText = '–°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –¥–µ—Å—è—Ç–∫–∏. –ï—Å–ª–∏ 5-9 ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ —Å–æ—Ç–Ω–∏';
                } else if (roundTo === 0.1) {
                    hintText = '–°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å–æ—Ç—ã–µ (–≤—Ç–æ—Ä–∞—è —Ü–∏—Ñ—Ä–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)';
                } else if (roundTo === 0.01) {
                    hintText = '–°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Ç—ã—Å—è—á–Ω—ã–µ (—Ç—Ä–µ—Ç—å—è —Ü–∏—Ñ—Ä–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)';
                }
                
                hint.textContent = hintText;
                hint.style.display = 'block';
            });
            
            // Rules toggle
            document.getElementById('rulesToggle').addEventListener('click', function() {
                const content = document.getElementById('rulesContent');
                const arrow = this.querySelector('span');
                content.classList.toggle('show');
                arrow.textContent = content.classList.contains('show') ? '‚ñ≤' : '‚ñº';
            });
            
            // Enter key support
            document.getElementById('userAnswer').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkAnswer();
                }
            });
        });
    </script>
</body>
</html>
